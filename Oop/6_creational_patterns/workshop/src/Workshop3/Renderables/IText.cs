// Интерфейсы для работы с текстовыми объектами, поддерживающими модификацию и клонирование
//
// Роль в проекте:
// Определяет контракт для текстовых объектов, которые могут быть модифицированы (стилизованы)
// и склонированы. Это основа для создания гибких текстовых элементов с возможностью
// динамического изменения их внешнего вида.
//
// Применяемые паттерны:
// 1. Prototype (Прототип) - через метод Clone() в IText<TSelf>
// 2. Decorator (Декоратор) - через AddModifier(), который позволяет добавлять новые
//    визуальные эффекты без изменения базового объекта
//
// Связь с другими компонентами:
// - Наследует IRenderable для поддержки рендеринга
// - Использует IRenderableModifier для применения стилей
// - Реализуется классом Text
// - Используется в TextExtensions для создания стилизованных копий текста
using Workshop3.RenderableModifiers;

namespace Workshop3.Renderables;

// Базовый интерфейс для текстовых объектов
//
// Определяет минимальный набор возможностей: доступ к значению и добавление модификаторов.
// Это немутирующий интерфейс в том смысле, что он не предоставляет способа изменить Value напрямую
// (хотя конкретная реализация может позволить это).
public interface IText : IRenderable
{
    // Текстовое содержимое объекта
    //
    // Это базовое значение, к которому затем применяются все модификаторы при рендеринге.
    // Важно: это свойство возвращает "сырое" значение без применения модификаторов.
    // Для получения стилизованного текста нужно вызвать метод Render().
    string Value { get; }

    // Добавляет модификатор для стилизации текста
    //
    // Параметры:
    //   modifier - объект модификатора, который будет применен при рендеринге
    //
    // Модификаторы применяются в порядке их добавления, образуя цепочку трансформаций.
    // Например, если добавить сначала BoldModifier, а затем ColorModifier, то текст
    // сначала станет жирным, а затем будет окрашен.
    void AddModifier(IRenderableModifier modifier);
}

// Обобщенный интерфейс для текстовых объектов с поддержкой клонирования
//
// Применяемый паттерн: Prototype (Прототип)
//
// Generic-параметр TSelf позволяет методу Clone() возвращать конкретный тип,
// а не базовый интерфейс. Это называется "Curiously Recurring Template Pattern" (CRTP)
// и обеспечивает типобезопасность при клонировании.
//
// Зачем нужно клонирование:
// При применении стилей через extension-методы (Bold(), Colored()) мы не хотим изменять
// исходный объект. Вместо этого создается копия с примененным модификатором.
// Это обеспечивает immutability API и предотвращает побочные эффекты.
public interface IText<TSelf> : IText
    where TSelf : IText<TSelf>
{
    // Создает копию текстового объекта с теми же модификаторами
    //
    // Возвращает: новый экземпляр того же типа с скопированным состоянием
    //
    // Паттерн Prototype позволяет создавать новые объекты путем копирования существующих,
    // что особенно полезно когда создание объекта с нуля сложнее, чем его копирование.
    // В нашем случае это позволяет сохранить все накопленные модификаторы.
    TSelf Clone();
}
