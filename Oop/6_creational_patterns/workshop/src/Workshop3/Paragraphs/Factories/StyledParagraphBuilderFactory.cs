// Фабрика для создания построителей стилизованных параграфов
//
// Роль в проекте:
// Конкретная реализация фабрики, которая создает StyledParagraphBuilder с
// заданным модификатором. Все параграфы, созданные через построители из этой
// фабрики, будут иметь одинаковую стилизацию.
//
// Применяемый паттерн:
// Abstract Factory (Абстрактная фабрика) + Dependency Injection (Внедрение зависимостей)
//
// Особенность реализации:
// Использует primary constructor (C# 12) для получения модификатора при создании фабрики.
// Этот модификатор затем передается каждому создаваемому построителю.
//
// Зачем передавать модификатор в фабрику:
// Это позволяет централизованно настроить стиль для всех параграфов.
// Например, создав фабрику с ColorModifier(Color.Red), мы гарантируем,
// что все параграфы, построенные через эту фабрику, будут красными.
// Это упрощает создание единообразно стилизованных наборов параграфов.
//
// Пример из Program.cs:
//   var factory = new StyledParagraphBuilderFactory(new ColorModifier(Color.Red));
//   // Все параграфы из этой фабрики будут красными
//
// Альтернативный подход:
// Можно было бы передавать модификатор в каждый вызов CreateBuilder(),
// но текущий подход удобнее, когда нужно создать несколько параграфов
// с одинаковым стилем.
//
// Модификатор доступа public:
// Фабрика доступна внешнему коду для создания стилизованных параграфов.
//
// Связь с другими компонентами:
// - Реализует интерфейс IParagraphBuilderFactory
// - Создает экземпляры StyledParagraphBuilder
// - Получает IRenderableModifier через конструктор (внедрение зависимости)
// - Используется в Program.cs для создания цветных параграфов
using Workshop3.Paragraphs.Builders;
using Workshop3.RenderableModifiers;

namespace Workshop3.Paragraphs.Factories;

public sealed class StyledParagraphBuilderFactory(IRenderableModifier modifier)
    : IParagraphBuilderFactory
{
    // Создает новый построитель для стилизованного параграфа
    //
    // Возвращает: новый экземпляр StyledParagraphBuilder с заданным модификатором
    //
    // Процесс:
    // 1. Создается новый StyledParagraphBuilder
    // 2. В него передается модификатор, полученный фабрикой при ее создании
    // 3. Возвращается построитель, готовый к использованию
    //
    // Каждый вызов CreateBuilder() создает новый независимый построитель,
    // но все они используют один и тот же модификатор. Это безопасно, потому что
    // модификаторы являются stateless (не хранят изменяемого состояния) и могут
    // переиспользоваться.
    //
    // Паттерн Factory + Flyweight:
    // Можно заметить элементы паттерна Flyweight - модификатор переиспользуется
    // между построителями, вместо создания нового для каждого построителя.
    // Это экономит память и повышает производительность.
    public IParagraphTitleSelector CreateBuilder()
    {
        return new StyledParagraphBuilder(modifier);
    }
}
