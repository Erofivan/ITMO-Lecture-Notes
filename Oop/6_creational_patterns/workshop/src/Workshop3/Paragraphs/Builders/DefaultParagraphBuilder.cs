// Построитель для создания обычных (нестилизованных) параграфов
//
// Роль в проекте:
// Конкретная реализация построителя, которая создает объекты DefaultParagraph.
// Наследует всю логику накопления данных от ParagraphBuilderBase и реализует
// только финальную сборку объекта.
//
// Применяемый паттерн:
// Builder (Строитель) + Template Method (Шаблонный метод)
//
// Зачем отдельный класс:
// Хотя класс содержит всего один метод, это соответствует принципу разделения
// ответственности. DefaultParagraphBuilder отвечает за создание обычных параграфов,
// а StyledParagraphBuilder - за создание стилизованных. Если в будущем потребуется
// дополнительная логика (например, валидация или трансформация данных), она будет
// добавлена сюда, не затрагивая другие построители.
//
// Модификатор доступа internal:
// Создание построителей должно происходить только через фабрики, поэтому класс
// недоступен за пределами сборки.
//
// Связь с другими компонентами:
// - Наследует ParagraphBuilderBase
// - Создает объекты DefaultParagraph
// - Создается через DefaultParagraphBuilderFactory
namespace Workshop3.Paragraphs.Builders;

internal sealed class DefaultParagraphBuilder : ParagraphBuilderBase
{
    // Создает готовый объект обычного параграфа
    //
    // Возвращает: новый экземпляр DefaultParagraph с накопленными данными
    //
    // Процесс сборки:
    // 1. Проверяет наличие обязательного заголовка (Title ?? throw)
    //    Если Title равен null, выбрасывается ArgumentNullException с понятным сообщением
    // 2. Передает все накопленные данные в конструктор DefaultParagraph
    // 3. Возвращает созданный объект
    //
    // Паттерн Null Object могли бы использовать вместо exception:
    // Вместо выброса исключения можно было бы подставить пустой заголовок,
    // но текущий подход строже и заставляет клиента явно указывать заголовок,
    // что соответствует бизнес-логике (параграф без заголовка не имеет смысла).
    //
    // Null-coalescing оператор (??):
    // Идиоматичный способ в C# для проверки и выброса исключения в одной строке.
    // Title ?? throw означает: "если Title не null, вернуть его значение,
    // иначе выбросить исключение".
    public override IParagraph Build()
    {
        return new DefaultParagraph(
            Title ?? throw new ArgumentNullException(nameof(Title)),
            Content,
            Footer);
    }
}
