// Файл определяет результат поиска переменной в контексте.
// Использует discriminated union для типобезопасного представления двух возможных исходов.

namespace Workshop2.Expressions.Expressions;

// VariableResolutionResult представляет результат попытки разрешения переменной.
// Это discriminated union (размеченное объединение), реализованное через
// абстрактный record с вложенными sealed record'ами.
//
// Паттерн проектирования: это C#-реализация концепции из функционального программирования,
// известной как "алгебраический тип данных" или "размеченное объединение".
// Преимущества:
// 1. Явно показывает все возможные варианты результата
// 2. Компилятор помогает не забыть обработать все случаи (через pattern matching)
// 3. Невозможно создать "невалидное" состояние
//
// В данном случае переменная либо найдена (Found), либо не найдена (NotFound).
// Это лучше, чем возвращать null или бросать исключение, так как явно
// показывает, что отсутствие переменной — это нормальная ситуация, а не ошибка.
public abstract record VariableResolutionResult
{
    // Приватный конструктор запрещает создание других наследников вне этого файла.
    // Это гарантирует, что существуют только два определённых ниже варианта.
    private VariableResolutionResult() { }

    // Вариант: переменная найдена в контексте.
    // Параметры:
    //   Value — числовое значение найденной переменной
    public sealed record Found(double Value) : VariableResolutionResult;

    // Вариант: переменная не найдена в контексте.
    // Не содержит дополнительных данных, так как факт отсутствия — это вся информация.
    public sealed record NotFound : VariableResolutionResult;
}
